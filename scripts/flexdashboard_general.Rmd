---
title: "Margaret"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(here)
library(tidyverse)
library(DT)
```

```{r}
articulos_unicos_2016_2020 <- 
  read_csv(here("data",
                "articulos_unicos.csv")) |> 
  filter(ano >= 2016,
         ano <=2020)
```

General
======================================================================

Column {data-width=500}
-----------------------------------------------------------------------

### Países

```{r}
articulos_unicos_2016_2020 |> 
  count(pais_revista, sort = TRUE) |> 
  datatable(options = list(pageLength = 5))
```

### Revistas

```{r}
articulos_unicos_2016_2020 |> 
  count(revista, sort = TRUE) |> 
  datatable(options = list(pageLength = 5))
```

Column {data-width=500}
-----------------------------------------------------------------------


### Paises por año

```{r}
paises_top <- 
  articulos_unicos_2016_2020 |> 
  count(pais_revista, sort = TRUE) |> 
  slice(1:6)


articulos_unicos_2016_2020 |> 
  filter(pais_revista %in% paises_top$pais_revista) |> 
  group_by(pais_revista, ano) |> 
  count(pais_revista) |> 
  ggplot(aes(x = ano, y = n, group = 1)) +
  geom_line() +
  facet_wrap(~ pais_revista) +
  theme(axis.text.x = element_text( size = 6 )) +
  xlab("año") +
  ylab("artículos") +
  ggtitle("Producción anual por paiz")
```


### Pevistas top por año

```{r}
revista_top <- 
  articulos_unicos_2016_2020 |> 
  count(revista, sort = TRUE) |> 
  slice(1:6)


articulos_unicos_2016_2020 |> 
  filter(revista %in% revista_top$revista) |> 
  group_by(revista, ano) |> 
  count(revista) |> 
  ggplot(aes(x = ano, y = n, group = 1)) +
  geom_line() +
  facet_wrap(~ revista) +
  theme(strip.text = element_text(size = 10),
        axis.text.x = element_text( size = 6 )) +
  xlab("año") +
  ylab("artículos") +
  ggtitle("Producción anual por revista")
```